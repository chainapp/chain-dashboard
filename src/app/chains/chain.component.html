<script type="text/javascript">
	$(function () {
	  $('[data-toggle="popover"]').popover()
	})
</script>
<!-- <div class="container-fluid" *ngIf="loaded"> -->
	<nav *ngIf="loaded" class="navbar navbar-light bg-faded" style="background-color:#F5F5F5;">
	  <a class="navbar-brand" [routerLink]="['/home']">
	    <i class="fa fa-arrow-circle-left fa-4" aria-hidden="true" style="color:#D8D8D8;"></i>
	  </a>	  	  
	  <span class="navbar-text float-xs-left">
	    <h5 class="display-5" style="color:#315A7B;">#{{chain.title}} &nbsp; &nbsp;</h5>
	  </span>
	  <span class="navbar-text float-xs-left text-muted">
	    {{chain.chainers_count}} users | {{chain.chainers.length+1}} pictures | {{chain.likes.length}} likes | {{chain.comments.length}} comments
	  </span>
		<span class="navbar-text float-xs-right text-muted" style="vertical-align:middle;">
			<label for="moderationswitch">Live moderation</label>
		  	<ui-switch id="moderationswitch" [checked]="chain.isAdvertising" (change)="toggleModeration();" size="small"></ui-switch>&nbsp;
		  	<i class="fa fa-question-circle" [popover]="helpmoderation" [popoverOnHover]="true" style="font-size:1.5em; color:#606060;"></i>
		  	&nbsp;		   
		    <div class="btn-group btn-group-sm">
			  <button type="button" class="btn btn-danger dropdown-toggle btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			    <i class="fa fa-video-camera" aria-hidden="true"></i> &nbsp; Broadcast Live
			  </button>
			  <div class="dropdown-menu">
			    <a class="dropdown-item" (click)="cast()">Cast chain on screen &nbsp; <i class="fa fa-television" aria-hidden="true"></i></a>
			    <a class="dropdown-item" href="https://live.wechain.eu/{{chain._id}}" target="_blank">Open live link in new tab &nbsp; <i class="fa fa-window-restore" aria-hidden="true"></i></a>
			  </div>
		  	</div>
		  	 &nbsp;
		  	 <i class="fa fa-question-circle" [popover]="helpbroadcast" [popoverOnHover]="true" style="font-size:1.5em; color:#606060;"></i>
		  	 &nbsp;
		  	<button type="button" class="btn btn-primary btn-sm navbar-text float-xs-right ">
			    <i class="fa fa-user-plus" aria-hidden="true"></i> &nbsp; Invite More
			</button>
			&nbsp;
		  	<i class="fa fa-cog fa-4" [popover]="actions" [popoverOnHover]="true" [popoverCloseOnMouseOutside]="true" style="font-size:1.5em; color:#606060;"></i>
		    
	    </span>
	    <popover-content #actions 
	            placement="bottom"
	            [closeOnMouseOutside]="true">
            <div class="row">
	            <span class="col-sm-9">Delete chain &nbsp;</span><span class="col-sm-3"><i class="fa fa-trash" role="button" aria-hidden="true" style="font-size:1.5em; color:#606060;"></i> </span>
	            <span class="col-sm-9">Show QR code &nbsp;</span><span class="col-sm-3"><ui-switch [checked]="chain.display_qrcode"  size="small"></ui-switch></span>
	        </div>
        </popover-content>
        <popover-content #helpmoderation 
	            placement="bottom">
	        <p>
	            Live moderation enables to manually validate each picture before it is posted to the whole chain.
	        </p>
	      </popover-content>
		  <popover-content #helpbroadcast
		            placement="bottom">
	        <p>
	            Live broadcast allows you to display your chain on a screen.
	        </p>
	      </popover-content>
	</nav>
<!-- </div> -->
<div class="container-fluid" *ngIf="loaded">
	<div class="row">
		<div class="col-sm-12 col-xs-12 col-md-12 col-lg-12">
			<div class="moderate-section">
				Photos to moderate
			</div>
		</div>
		<div *ngIf="chain.isAdvertising && chain.moderation.length != 0" class="col-sm-12 col-xs-12 col-md-12 col-lg-12">
		    <div *ngFor='let moderate of chain.moderation' class="hovereffect" style="margin-right:1%;">
		      <img src="https://thumbnails.wechain.eu/{{moderate.thumbnails[0]}}" class="img-fluid">
		      	<div class="overlay" style="vertical-align: center;"><h6 style="color:white;" class='display-6'>{{moderate.username}}</h6>
			         <button class="btn btn-sm btn-success"  type="button" uib-dropdown-toggle="" (click)="approve(moderate)">Approve</button>
			         <button class="btn btn-sm btn-danger"  type="button" uib-dropdown-toggle="" (click)="refuse(moderate)">Refuse</button>
		        </div>
		    </div> 
		</div>
		<div *ngIf="!chain.isAdvertising" class="col-sm-12 col-xs-12 col-md-12 col-lg-12">
		    <h4 class="display-5 text-xs-center">Live moderation is not enabled for this chain</h4>
		</div>
		<div *ngIf="chain.isAdvertising && chain.moderation.length == 0" class="col-sm-12 col-xs-12 col-md-12 col-lg-12">
		    <h4 class="display-5 text-xs-center">No picture to moderate right now, come back later </h4>
		</div>
	</div>
</div>
<div class="container-fluid" *ngIf="loaded" >
	<div class="row">
		<div class="col-sm-12 col-xs-12 col-md-12 col-lg-12">
			<div class="posted-section">
				Posted photos
			</div>
		</div>
		<div class="col-sm-12 col-xs-12 col-md-12 col-lg-12">
		    <div *ngFor='let chainer of chain.chainers' class="hovereffect" style='width:10%;margin-right:1%;margin-bottom:1%;'>
		      <img src="https://thumbnails.wechain.eu/{{chainer.thumbnails[0]}}" class="img-fluid">
		      	<div class="overlay" style="vertical-align: center;"><h6 style="color:white;" class='display-6'>{{chainer.username}}</h6>
			         <button class="btn btn-sm btn-info"  type="button" (click)="see(chainer)">See</button>
			         <button class="btn btn-sm btn-danger"  type="button" uib-dropdown-toggle="" (click)="delete(chainer)">Delete</button>
		        </div>
		    </div> 
		</div>
	</div>
</div>
<toaster-container></toaster-container>
